# Tests for the html module.
#
# This file contains a collection of tests for a module in the
# Standard Tcl Library. Sourcing this file into Tcl runs the tests and
# generates output for errors.  No output means no errors were found.
#
# Copyright (c) 1998-2000 by Scriptics Corporation.
#
# See the file "license.terms" for information on usage and redistribution
# of this file, and for a DISCLAIMER OF ALL WARRANTIES.
#
# RCS: @(#) $Id: html.test,v 1.1 2000/04/19 04:14:54 welch Exp $

package require tcltest
namespace import -force ::tcltest::*

set myFile [file join [file dirname [info script]] html.tcl]
source $myFile
package require html 1.0

test html-1.1 {html::reset} {
    html::reset
    list [array exists html::defaults] \
	[array size html::defaults] \
	[info exists html::page]
} {1 0 0}

test html-1.2 {html::reset} {
    html::reset {
	font.face	arial
	body.bgcolor	white
	body.text	black
    }
    lsort [array names html::defaults]
} {body.bgcolor body.text font.face}

test html-1.3 {html::reset} {
    catch {html::reset wrong num args}
} 1

test html-1.4 {html::reset} {
    catch {html::reset {wrong num args}}
} 1

test html-2.1 {html::head} {
    catch {html::head}
} 1

test html-2.2 {html::head} {
    html::head "The Title"
} "<html><head>\n\t<title>The Title</title>\n</head>\n"

test html-2.3 {html::head} {
    html::description "The Description"
    html::keywords key word
    html::author "Cathy Coder"
    html::meta metakey metavalue
    html::head "The Title"
} {<html><head>
	<title>The Title</title>
	<!-- Cathy Coder -->
	<meta name="description" value="The Description">
	<meta name="keywords" value="key, word">
	<meta name="metakey" value="metavalue">
</head>
}

test html-3.1 {html::title} {
    catch html::title
} 1

test html-3.2 {html::title} {
    html::title "blah blah"
} "<title>blah blah</title>\n"

test html-4.1 {html::getTitle} {
    html::reset
    html::getTitle
} ""

test html-4.2 {html::getTitle} {
    html::reset
    html::title "blah blah"
    html::getTitle
} {blah blah}

test html-5.1 {html::meta} {
    html::reset
    html::meta one two
} {}

test html-5.2 {html::meta} {
    html::reset
    html::meta one two
    lindex $html::page(meta) 0
} {<meta name="one" value="two">}

test html-5.3 {html::meta} {
    html::reset
    html::meta one {"one val"}
    lindex $html::page(meta) 0
} {<meta name="one" value="&#34;one val&#34;">}

test html-6.1 {html::keywords} {
    html::reset
    html::keywords one two
} {}

test html-6.2 {html::keywords} {
    html::reset
    html::keywords one two
    lindex $html::page(meta) 0
} {<meta name="keywords" value="one, two">}

test html-6.3 {html::keywords} {
    html::reset
    html::keywords one {"one val"} &
    lindex $html::page(meta) 0
} {<meta name="keywords" value="one, &#34;one val&#34;, &amp;">}

test html-7.1 {html::description} {
    html::reset
    html::description "This is the description."
} {}

test html-7.2 {html::description} {
    html::reset
    html::description "This is the description."
    lindex $html::page(meta) 0
} {<meta name="description" value="This is the description.">}

test html-7.3 {html::description} {
    html::reset
    html::description {one "one val" &}
    lindex $html::page(meta) 0
} {<meta name="description" value="one &#34;one val&#34; &amp;">}

