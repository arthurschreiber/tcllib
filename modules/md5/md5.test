# -*- tcl -*-
# md5.test:  tests for the md5 commands
#
# This file contains a collection of tests for one or more of the Tcl
# built-in commands.  Sourcing this file into Tcl runs the tests and
# generates output for errors.  No output means no errors were found.
#
# Copyright (c) 2001 by ActiveState Tool Corp.
# All rights reserved.
#
# RCS: @(#) $Id: md5.test,v 1.1 2001/04/24 23:21:44 andreas_kupries Exp $

if {[lsearch [namespace children] ::tcltest] == -1} {
    package require tcltest
    namespace import ::tcltest::*
}

package require md5
puts "md5 [package present md5]"

#namespace import ::md5::md5
#namespace import ::md5::hmac


test md5-1.0 {md5} {
    catch {::md5::md5} result
    set result
} {no value given for parameter "msg" to "::md5::md5"}

test md5-1.1 {md5} {
    catch {::md5::hmac} result
    set result
} {no value given for parameter "key" to "::md5::hmac"}

test md5-1.2 {md5} {
    catch {::md5::hmac key} result
    set result
} {no value given for parameter "text" to "::md5::hmac"}


foreach {n msg expected} {
    1    ""
    "d41d8cd98f00b204e9800998ecf8427e"
    2    "a"
    "0cc175b9c0f1b6a831c399e269772661"
    3    "abc"
    "900150983cd24fb0d6963f7d28e17f72"
    4    "message digest"
    "f96b697d7cb7938d525a2f31aaf161d0"
    5    "abcdefghijklmnopqrstuvwxyz"
    "c3fcd3d76192e4007dfb496cca67e13b"
    6    "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"
    "d174ab98d277d9f5a5611c2c9f419d9f"
    7    "12345678901234567890123456789012345678901234567890123456789012345678901234567890"
    "57edf4a22be3c955ac49da2e2107b67a"
} {
    test md5-2.$n {md5} {
	::md5::md5 $msg
    } $expected ; # {}
}

::tcltest::cleanupTests
